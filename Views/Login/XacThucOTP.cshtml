@model mi_pham_kem.Models.SQLServer.User
@{
    Layout = null;
    ViewData["Title"] = "Đăng nhập";
    var email = Context.Session.GetString("TempUser_Email") ?? "email không xác định";
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="~/css/login.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Edu+NSW+ACT+Cursive:wght@400..700&family=Edu+VIC+WA+NT+Hand+Pre:wght@400..700&family=Pacifico&family=Quicksand:wght@300..700&family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Quicksand", sans-serif;
        }

        body {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            padding: 15px;
            background-image: url('/lib/image/banner2.png');
            overflow: hidden;
            background-position: center;
        }

        .wrapper {
            max-width: 500px;
            width: 100%;
            background: #fff;
            border-radius: 5px;
            box-shadow: 0px 4px 10px 1px rgba(0, 0, 0, 0.1);
        }

        .wrapper .title {
            height: 120px;
            background-color: #de5f94;
            border-radius: 5px 5px 0 0;
            color: #fff;
            font-size: 30px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: "Pacifico", cursive;
        }

        .wrapper form {
            padding: 25px 35px;
        }

        .wrapper form .row {
            height: 60px;
            margin-top: 15px;
            position: relative;
        }

        .wrapper form .row input {
            height: 100%;
            width: 100%;
            outline: none;
            padding-left: 70px;
            padding-right: 40px;
            border-radius: 5px;
            border: 1px solid lightgrey;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        form .row input:focus {
            border-color: #de5f94;
        }

        form .row input::placeholder {
            color: #999;
        }

        .wrapper form .row i.input-icon-left {
            position: absolute;
            width: 55px;
            height: 100%;
            color: #fff;
            font-size: 22px;
            background: #de5f94;
            border: 1px solid #de5f94;
            border-radius: 5px 0 0 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            left: 0;
            top: 0;
        }

        .wrapper form .row i.input-icon-eye {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            font-size: 18px;
            color: gray;
        }

        .wrapper form .row i.input-icon-eye:hover {
            color: #de5f94;
        }

        .wrapper form .pass {
            margin-top: 12px;
        }

        .wrapper form .pass a {
            color: #de5f94;
            font-size: 17px;
            text-decoration: none;
        }

        .wrapper form .pass a:hover {
            text-decoration: underline;
        }

        .wrapper form .button input {
            margin-top: 20px;
            color: #fff;
            font-size: 20px;
            font-weight: 500;
            padding-left: 0px;
            background: #de5f94;
            border: 1px solid #de5f94;
            cursor: pointer;
            height: 60px;
            width: 100%;
            border-radius: 50px;
            text-align: center;
            padding: 0; 
        }

        form .button input:hover {
            background: #b33e6f;
        }

        .wrapper form .signup-link {
            text-align: center;
            margin-top: 45px;
            font-size: 17px;
        }

        .wrapper form .signup-link a {
            color: #de5f94;
            text-decoration: none;
        }

        form .signup-link a:hover {
            text-decoration: underline;
        }

        .pacifico-regular {
            font-family: "Pacifico", cursive;
            font-weight: 400;
            font-style: normal;
        }

        .button-row {
            display: flex;
            gap: 10px;
        }

            .button-row input {
                flex: 1;
                height: 60px;
                border-radius: 50px;
                color: #fff;
                font-size: 18px;
                font-weight: 500;
                background: #de5f94;
                border: 1px solid #de5f94;
                cursor: pointer;
                text-align: center;
                display: flex;
                align-items: center;
                justify-content: center;
            }

                .button-row input:hover {
                    background: #b33e6f;
                }

            .button-row .btn-back {
                background: gray;
                border-color: gray;
            }

                .button-row .btn-back:hover {
                    background: #555;
                }

        a{
            font-weight: bold;
            color: #de5f94;
        }
            a hover{
                background: #b33e6f;
            }
    </style>
</head>
<body>

    <div class="wrapper">
        <div class="title" style="font-family: 'Pacifico', cursive;"><span>Xác thực OTP</span></div>
        <p style="margin:20px; text-align:justify">Chúng tôi sẽ gửi 1 mã xác thực qua email: <strong>@email</strong> , vui lòng kiểm tra email để nhận mã.</p>
        @using (Html.BeginForm("XacThucOTP", "Login", FormMethod.Post))
        {
            @Html.AntiForgeryToken()

            <div class="row">
                <i class="fas fa-key input-icon-left"></i>
                @Html.TextBox("otpNhap", null, new { placeholder = "Nhập mã OTP" })
            </div>

            @if (ViewBag.ErrorInfo != null)
            {
                <p class="text-danger mt-2" style="color:red; margin: 10px">@ViewBag.ErrorInfo</p>
            }
<div style="margin: 15px; text-align: center">
    <p id="countdownText">Gửi lại mã sau <span id="countdown">60</span>s</p>
    <a id="resendLink" href="@Url.Action("GuiLaiOTP", "Login")" style="display:none;">Gửi lại mã</a>
</div>

            <div class="row button-row" style="padding: 0px; ">
                <input type="submit" value="Xác thực mã" class="btn-otp" style="border-radius: 999px; padding: 0; " />
                <input onclick="window.history.back()" value="Quay lại" class="btn-otp btn-back" style="border-radius: 999px; padding: 0; " />
            </div>
        }
    </div>

    <script>
        let timeLeft = 60;
        const countdownElem = document.getElementById("countdown");
        const countdownText = document.getElementById("countdownText");
        const resendLink = document.getElementById("resendLink");

        const countdownTimer = setInterval(function () {
            timeLeft--;
            countdownElem.textContent = timeLeft;

            if (timeLeft <= 0) {
                clearInterval(countdownTimer);
                countdownText.style.display = "none";
                resendLink.style.display = "inline";
            }
        }, 1000);
    </script>


</body>
</html>
